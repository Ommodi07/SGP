<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Courses - Course Crafter</title>
    <link rel="stylesheet" href="enroll.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"/>
    <style>
        .courses-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 0 1rem;
        }

        .course-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            display: flex;
            gap: 2rem;
            background: #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .course-image {
            width: 200px;
            height: 150px;
            object-fit: cover;
            border-radius: 4px;
        }

        .course-details {
            flex: 1;
        }

        .course-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
            color: #333;
        }

        .course-description {
            color: #555;
            margin-bottom: 1rem;
        }

        .start-button {
            background-color: #007bff;
            color: white;
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .start-button:hover {
            background-color: #0056b3;
        }

        .no-courses {
            text-align: center;
            padding: 3rem;
            color: #666;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div>
                <img src="image/logo.png" id="logo">
            </div>
            <div class="navbar-element">
                <div class="elments"><A href="index.html">Home</A></div>
                <div class="elments"><A href="Course.html">Course</A></div>
                <div class="elments"><A>Find Job</A></div>
                <div class="elments"><A href="FAQ.html">FAQ</A></div>
            </div>
        </div>
    </nav>

    <div class="courses-container">
        <h1>My Enrolled Courses</h1>
        <div id="purchased-courses">
            <!-- Courses will be loaded here dynamically -->
        </div>
    </div>

    <script>
        // Fetch the user's purchased courses
        const token = localStorage.getItem('userToken');

console.log(token);
            if (!token) {
                alert('Please login to enroll in this course');
                window.location.href = 'login.html';
                
            }
        fetch('http://localhost:3000/user/purchases',{ headers: {
          'Content-Type': 'application/json',
          'Authorization': ` ${token}`
        }})
        .then(response => response.json())
.then(data => {
  if (data.success) {
    // Populate the #purchased-courses element with the course details
    const purchasedCourses = data.purchases;
    const purchasedCoursesElement = document.getElementById('purchased-courses');

    purchasedCourses.forEach(purchase => {
      const courseElement = document.createElement('div');
      courseElement.classList.add('course-item');
      courseElement.innerHTML = `
        <img src="${purchase.courseDetails.imageUrl}" alt="${purchase.courseDetails.title}">
        <h3>${purchase.courseDetails.title}</h3>
        <p>${purchase.courseDetails.description}</p>
      `;
      purchasedCoursesElement.appendChild(courseElement);
    });
  } else {
    // Display an error message
    alert(data.message);
  }
})
.catch(error => {
  // Handle any errors
  console.error('Error:', error);
});
      </script>

    <footer>
        <div class="footer-content">
            <div class="footer-col footer-col-1">
                <div class="col-title">
                    <img src="/image/logo1.png" alt="">
                </div>
                <div class="col-content">
                    <p>Course Crafter is website for active-learning and finding jobs for young aspiring minds.
                    which is instrumental for self-actualisation providing opportunities for a life-long learning.
                    </p>
                </div>
            </div>
            <div class="footer-col footer-col-2">
                <div class="col-title">
                    <h3>Contact</h3>
                </div>
                <div class="col-content">
                    <div class="content-row">
                        <span>Phone</span>
                        <span>+91 9825-854632</span>
                    </div>
                    <div class="content-row">
                        <span>Website</span>
                        <span>CourseCrafter.com</span>
                    </div>
                    <div class="content-row">
                        <span>E-mail</span>
                        <span>info@CourseCrafter.com</span>
                    </div>
                </div>
            </div>
            <div class="footer-col footer-col-3">
                <div class="col-title">
                    <h3>Quick links</h3>
                </div>
                <div class="col-content">
                    <a href="index.html">Home</a>
                    <a href="Course.html">Course</a>
                    <a href="FJ.html">Find Job</a>
                    <a href="FAQ.html">FAQ</a>
                </div>
            </div>
        </div>
        <div class="copy-rights">
            <p>All Rights Reserved</p>
        </div>
    </footer>
</body>
</html>